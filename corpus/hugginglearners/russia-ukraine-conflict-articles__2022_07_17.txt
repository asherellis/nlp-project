The office has grown to about 25 negotiators and other officials in recent years, up from five, as more Americans are detained by foreign governments. Each case is assigned an expert on the country where the person is being held.

The process is extremely difficult, said the senior State Department official, who spoke on the condition that he not be named to describe some functions of the office.

All of the foreign governments that are detaining Americans have, at best, rocky relations with the United States. In some cases, like Iran, messages are sent through other governments that serve as intermediaries; in others, U.S. officials work through levels of the foreign government’s bureaucracy to get to someone senior enough to influence a decision.

The communications are intended to reinforce the consequences of continuing to hold Americans captive, the official said.

He said foreign governments often felt as if they were the aggrieved party and usually began with demands that he called unreasonable.

The State Department does not provide legal assistance to the detained Americans or their families.

Does the United States pay ransom or swap prisoners?

A 2015 directive by President Barack Obama prohibits promising “ransom, prisoner releases, policy changes or other acts of concession” to bring detained Americans home. The policy takes away key incentives for hostage takers to detain Americans in the first place and prevents the exchange of U.S. revenue or other resources that could be used for other nefarious activities, the document notes.